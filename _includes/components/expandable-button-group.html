{% comment %}
Parameters:
- group_name: The name of the button group (e.g., "Projects")
- group_items: Array of items with properties:
  - title: Display title
  - url: Link URL
  - icon: Optional emoji or icon
{% endcomment %}

<span class="expandable-button-group" style="display: contents;">
    <a href="#" class="icon-link text-link expand-button" title="{{ include.group_name }}" style="width: auto; min-width: 36px; height: 36px; border-radius: 8px;">
        <span style="display: flex; align-items: center; gap: 0.25rem;">
            {{ include.group_name }}
        </span>
    </a>
    <a href="#" class="icon-link text-link close-button" title="Close" style="display: none; width: auto; min-width: 36px; height: 36px; border-radius: 8px;">
        <span style="display: flex; align-items: center; gap: 0.25rem;">
            <i class="fas fa-times"></i>
        </span>
    </a>
    {% for item in include.group_items %}
    <a href="{{ item.url }}" class="icon-link text-link expanded-button" title="{{ item.title }}" style="display: none; width: auto; min-width: 36px; height: 36px; border-radius: 8px;">
        <span>{% if item.icon %}{{ item.icon }} {% endif %}{{ item.title }}</span>
    </a>
    {% endfor %}
</span>

<script>
document.addEventListener('DOMContentLoaded', function() {
    try {
        console.log('Initializing expandable button group...');
        const container = document.currentScript.previousElementSibling;
        const expandButton = container.querySelector('.expand-button');
        const closeButton = container.querySelector('.close-button');
        const expandedButtons = container.querySelectorAll('.expanded-button');
        
        if (!expandButton || !closeButton || expandedButtons.length === 0) {
            console.error('Missing required elements:', {
                expandButton: !!expandButton,
                closeButton: !!closeButton,
                expandedButtonsCount: expandedButtons.length
            });
            return;
        }

        console.log('Found all required elements:', {
            expandButton: !!expandButton,
            closeButton: !!closeButton,
            expandedButtonsCount: expandedButtons.length
        });

        function showExpanded() {
            console.log('Showing expanded state...');
            expandButton.style.display = 'none';
            closeButton.style.display = 'inline-flex';
            expandedButtons.forEach(button => {
                button.style.display = 'inline-flex';
            });
            console.log('Expanded state shown successfully');
        }

        function hideExpanded() {
            console.log('Hiding expanded state...');
            expandButton.style.display = 'inline-flex';
            closeButton.style.display = 'none';
            expandedButtons.forEach(button => {
                button.style.display = 'none';
            });
            console.log('Expanded state hidden successfully');
        }

        expandButton.addEventListener('click', function(e) {
            console.log('Expand button clicked');
            e.preventDefault();
            e.stopPropagation();
            showExpanded();
        });

        closeButton.addEventListener('click', function(e) {
            console.log('Close button clicked');
            e.preventDefault();
            e.stopPropagation();
            hideExpanded();
        });

        // Close the expanded buttons when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.nav-buttons')) {
                console.log('Clicked outside nav-buttons');
                hideExpanded();
            }
        });

        console.log('Expandable button group initialized successfully');
    } catch (error) {
        console.error('Error in expandable button group:', error);
    }
});
</script> 